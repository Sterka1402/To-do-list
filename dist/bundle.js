(()=>{"use strict";const t=async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(e.status);return e.json()}catch(t){console.log(`Error: server responded: ${t.message}`)}},e=t=>{const e=t.filter((t=>!t.done)),n=e.length?`You have ${e.length} tasks today!`:"No tasks today!";document.querySelector(".task-counting").innerHTML=`\n    <p>${n}</p>\n    `},n=(t,e)=>{e.innerHTML=t.map((t=>`\n    <li class="${t.done?"check-list done-list":"check-list"}" data-key="${t.id}" >\n    <img class='remove-list' src='./src/icons/trash.svg' alt="Delete">\n    ${t.text}</li>\n  `)).join("")},s=async(s,o,a)=>{if(""!==o.value){const r={text:o.value,done:!1};await(async(t,e)=>{const n={headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)};try{const e=await fetch(t,n);if(!e.ok)throw new Error(e.status);return e.json()}catch(t){console.log(`Error: server responded: ${t.message}`)}})(a,r);const c=await t(a)||[];localStorage.setItem("list",JSON.stringify(c)),e(c),n(c,s),o.value=""}};window.addEventListener("load",(async()=>{const o=document.querySelector(".list-container"),a=document.getElementById("new-task"),r=document.getElementById("add-btn"),c="http://localhost:3000/lists",i=await t(c)||[];(function(){const t=document.querySelector(".current-date"),e=new Date,n=e.getDay();t.innerHTML=`\n  <h1>Hello!</h1>\n  <p>Today is ${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n]}, ${e.toLocaleDateString()}.</p>\n  `})(),e(i),n(i,o),a.addEventListener("keydown",(t=>function(t,e,n,o){13===t.keyCode&&s(e,n,o)}(t,o,a,c))),r.addEventListener("click",(()=>s(o,a,c))),o.addEventListener("click",(e=>(async(e,s,o)=>{if(e.target.classList.contains("remove-list")&&"IMG"===e.target.tagName){const a=e.target.closest("LI").dataset.key;let r=JSON.parse(localStorage.getItem("list"))||[];console.log(r);for(let t=0;t<r.length;t++)if(r[t].id===Number(a)&&!r[t].done)return;await(async(t,e)=>{const n={method:"DELETE"};try{const s=await fetch(`${t}/${e}`,n);if(!s.ok)throw new Error(s.status);return s.json()}catch(t){console.log(`Error: server responded: ${t.message}`)}})(o,a),r=await t(o),localStorage.setItem("list",JSON.stringify(r)),n(r,s)}})(e,o,c))),o.addEventListener("click",(s=>(async(s,o,a)=>{if(s.target.classList.contains("check-list")&&"LI"===s.target.tagName){let r,c=0,i=JSON.parse(localStorage.getItem("list"))||[];console.log(i),c=s.target.dataset.key;for(let t=0;t<i.length;t++)i[t].id===Number(c)&&(i[t].done=!i[t].done,r=i[t]);await(async(t,e,n)=>{const s={headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify(e)};try{const e=await fetch(`${t}/${n}`,s);if(!e.ok)throw new Error(e.status);return e.json()}catch(t){console.log(`Error: server responded: ${t.message}`)}})(a,r,c),i=await t(a),localStorage.setItem("list",JSON.stringify(i)),e(i),n(i,o)}})(s,o,c)))}))})();